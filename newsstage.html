<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>News Headlines Card</title>
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: 'DSFont', monospace;
    background: #d7d7d7;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  @font-face {
    font-family: 'DSFont';
    src: local('Courier New');
  }

  .news-card {
    width: 256px;
    background: #f8f8f8;
    border: 3px solid #888;
    border-radius: 4px;
    padding: 10px;
    color: #000;
    image-rendering: pixelated;
    box-shadow: inset 0 0 0 2px #fff, 0 0 0 4px #555;
  }

  .headline {
    margin-bottom: 6px;
    padding: 6px;
    background: #ffffff;
    border: 2px solid #aaa;
    border-radius: 2px;
    text-decoration: none;
    color: #000;
    display: block;
    font-size: 12px;
  }

  .headline:hover {
    background: #e3e3e3;
  }

  .title {
    font-weight: bold;
  }

  .source {
    font-size: 10px;
    opacity: 0.75;
    margin-top: 2px;
  }
</style>
</head>
<body>
  <div class="news-card" id="news-card">Loading news...</div>

<script>
// =============== RSS FEED MAP =====================
const FEEDS = {
  top: "https://www.cbc.ca/webfeed/rss/rss-topstories",
  world: "https://www.cbc.ca/webfeed/rss/rss-world",
  canada: "https://www.cbc.ca/webfeed/rss/rss-canada",
  politics: "https://www.cbc.ca/webfeed/rss/rss-politics",
  business: "https://www.cbc.ca/webfeed/rss/rss-business",
  health: "https://www.cbc.ca/webfeed/rss/rss-health",
  arts: "https://www.cbc.ca/webfeed/rss/rss-arts",
  tech: "https://www.cbc.ca/webfeed/rss/rss-technology",
  indigenous: "https://www.cbc.ca/webfeed/rss/rss-Indigenous",
  sports: "https://www.cbc.ca/webfeed/rss/rss-sports",
  mlb: "https://www.cbc.ca/webfeed/rss/rss-sports-mlb",
  nba: "https://www.cbc.ca/webfeed/rss/rss-sports-nba",
  curling: "https://www.cbc.ca/webfeed/rss/rss-sports-curling",
  cfl: "https://www.cbc.ca/webfeed/rss/rss-sports-cfl",
  nfl: "https://www.cbc.ca/webfeed/rss/rss-sports-nfl",
  nhl: "https://www.cbc.ca/webfeed/rss/rss-sports-nhl",
  soccer: "https://www.cbc.ca/webfeed/rss/rss-sports-soccer",
  figureskating: "https://www.cbc.ca/webfeed/rss/rss-sports-figureskating",
  golf: "https://www.cbc.ca/webfeed/rss/rss-sports-golf",
  olympics: "https://www.cbc.ca/webfeed/rss/rss-sports-olympics",
  skiing: "https://www.cbc.ca/webfeed/rss/rss-sports-skiing",
  tennis: "https://www.cbc.ca/webfeed/rss/rss-sports-tennis",
};

// =============== URL PARAMS =======================
const params = new URLSearchParams(location.search);
const feedParam = params.get("feed") || "top";
const limit = parseInt(params.get("limit")) || 5;

// =============== RSS FETCH FUNCTION ===============
async function loadRSS(url) {
  try {
    const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`);
    const data = await res.json();
        const items = data.items || [];
    return items.slice(0, limit).map(item => ({
      title: item.title || "Untitled",
      link: item.link || "#",
      source: item.author || "CBC",
    }));
   
  } catch (err) {
    console.error(err);
    return [];
  }
}

// =============== RENDER ===========================
async function loadNews() {
  const feedURL = FEEDS[feedParam] || FEEDS.top;
  const card = document.getElementById("news-card");
  card.innerHTML = "Loading...";

  const items = await loadRSS(feedURL);
  card.innerHTML = "";

  items.forEach(article => {
    const div = document.createElement("a");
    div.href = article.link;
    div.target = "_blank";
    div.className = "headline";
    div.innerHTML = `
      <div class="title">${article.title}</div>
      <div class="source">${article.source}</div>
    `;
    card.appendChild(div);
  });
}

loadNews();
</script>
</body>
</html>
